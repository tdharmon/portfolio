@import '../../styles/_variables';

@function code-color($theme, $name) {
  @if ($theme != 'light' and $theme != 'dark') {
    @error 'You must pass in either light or dark as the theme';
  }

  $colors: (
    code-background: (
      light: color(light, caption-bg),
      dark: color(dark, caption-bg),
    ),
    code-border: (
      light: darken(color(light, caption-bg), 15%),
      dark: lighten(color(dark, caption-bg), 25%),
    ),
    pre-background: (
      light: color(dark, caption-bg),
      dark: color(dark, caption-bg),
    ),
    pre-border: (
      light: darken(#111, 5%),
      dark: darken(#111, 5%),
    ),
    selection: (
      light: darken(color(light, caption-bg), 10%),
      dark: lighten(color(dark, caption-bg), 10%),
    ),
    keyword: (
      light: #beaaf9,
      dark: #beaaf9,
    ),
    string: (
      light: #c1e38a,
      dark: #c1e38a,
    ),
    punctuation: (
      light: darken(color(dark, text), 20%),
      dark: darken(color(dark, text), 20%),
    ),
    class: (
      light: #70cde3,
      dark: #70cde3,
    ),
    comment: (
      light: #999988,
      dark: #999988,
    ),
    function: (
      light: #fcd58b,
      dark: #fcd58b,
    ),
    tag: (
      light: #00009f,
      dark: #00009f,
    ),
  );

  $selected-color-map: map-get($colors, $name);
  @return map-get($selected-color-map, $theme);
}

/**
 * GHColors theme by Avi Aryan (http://aviaryan.in)
 * Inspired by Github syntax coloring
 */

code[class*='language-'],
pre[class*='language-'] {
  // font-family: "Consolas", "Bitstream Vera Sans Mono", "Courier New", Courier, monospace;
  direction: ltr;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  font-size: 0.95em;
  line-height: 1.2em;
  border-radius: 3px;

  tab-size: 4;
  hyphens: none;
}

.Light {
  code[class*='language-'] {
    color: lighten(color(light, text-bold), 10%);

    background-color: code-color(light, code-background);
    border: 1px solid code-color(light, code-border);

    &::selection,
    & ::selection {
      background: code-color(light, selection);
    }
  }

  pre[class*='language-'],
  pre[class*='language-'] > code[class*='language'] {
    & > code[class*='language-'] {
      background-color: transparent;
      border-color: transparent;
    }

    color: lighten(color(dark, text-bold), 10%);

    background-color: code-color(dark, pre-background);

    &::selection,
    & ::selection {
      background: code-color(dark, selection);
    }
  }
}

.Dark {
  code[class*='language-'],
  pre[class*='language-'] {
    color: lighten(color(dark, text-bold), 10%);

    background-color: code-color(dark, pre-background);
    border: 1px solid code-color(dark, code-border);

    &::selection,
    & ::selection {
      background: code-color(dark, selection);
    }
  }

  pre[class*='language-'],
  pre[class*='language-'] > code[class*='language'] {
    & > code[class*='language-'] {
      background-color: transparent;
      border-color: transparent;
    }

    color: lighten(color(dark, text-bold), 10%);
    border-color: transparent;
    background-color: code-color(dark, pre-background);

    &::selection,
    & ::selection {
      background: code-color(dark, selection);
    }
  }
}

/* Code blocks */
pre[class*='language-'] {
  padding: 1em;
  margin: 0;
  overflow: auto;

  code {
    border: none;
  }
}

:not(pre) > code[class*='language-'],
pre[class*='language-'] {
}

/* Inline code */
:not(pre) > code[class*='language-'] {
  padding: 0 0.25rem;
  display: inline-block;
}

.token {
  &.comment,
  &.prolog,
  &.doctype,
  &.cdata {
    font-style: italic;
  }

  &.namespace {
    opacity: 0.7;
  }

  &.important,
  &.bold {
    font-weight: bold;
  }

  &.italic {
    font-style: italic;
  }
}

.Light {
  .token {
    &.comment,
    &.prolog,
    &.doctype,
    &.cdata {
      color: code-color(light, comment);
    }

    &.class-name {
      color: code-color(light, class);
    }

    &.string,
    &.attr-value {
      color: code-color(light, string);
    }

    &.punctuation {
      color: code-color(light, punctuation);
    }

    &.operator {
      color: code-color(light, keyword);
    }

    &.entity,
    &.url,
    &.symbol,
    &.number,
    &.boolean,
    &.variable,
    &.constant,
    &.property,
    &.regex,
    &.inserted {
      color: code-color(light, class);
    }

    &.atrule,
    &.keyword,
    &.attr-name,
    .language-autohotkey &.selector {
      color: code-color(light, keyword);
    }

    &.function,
    &.deleted,
    .language-autohotkey &.tag {
      color: code-color(light, function);
    }

    &.tag,
    &.selector,
    .language-autohotkey &.keyword {
      color: code-color(light, tag);
    }
  }
}

.Dark {
  .token {
    &.comment,
    &.prolog,
    &.doctype,
    &.cdata {
      color: code-color(dark, comment);
    }

    &.class-name {
      color: code-color(dark, class);
    }

    &.string,
    &.attr-value {
      color: code-color(dark, string);
    }

    &.punctuation {
      color: code-color(dark, punctuation);
    }

    &.operator {
      color: code-color(dark, keyword);
    }

    &.entity,
    &.url,
    &.symbol,
    &.number,
    &.boolean,
    &.variable,
    &.constant,
    &.property,
    &.regex,
    &.inserted {
      color: code-color(dark, class);
    }

    &.atrule,
    &.keyword,
    &.attr-name,
    .language-autohotkey &.selector {
      color: code-color(dark, keyword);
    }

    &.function,
    &.deleted,
    .language-autohotkey &.tag {
      color: code-color(dark, function);
    }

    &.tag,
    &.selector,
    .language-autohotkey &.keyword {
      color: code-color(dark, tag);
    }
  }
}
